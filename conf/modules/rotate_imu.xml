<!DOCTYPE module SYSTEM "module.dtd">
<module name="rotate_imu" dir="imu">
  <doc>
    <description>
    Module developed to rotate the IMU data before sending it to the state estimation. 

    In order to use this rotation for your IMU (on Gyro and Acell data, Mag passthrough), you only
     need to redefine the source of data in the ABI bindings of the AHRS/INS filter being used.
    For instance, if the 'ahrs_int_cmpl_quat' AHRS is used, this module should be loaded with the 
    following options:
        define name="AHRS_ICQ_IMU_ID" value="IMU_ROT_ID"     
        define name="AHRS_ICQ_MAG_ID" value="IMU_ROT_ID" 
        define name="AHRS_ALIGNER_IMU_ID" value="IMU_ROT_ID"

    if the 'ahrs_float_cmpl_quat' AHRS is used,
        define name="AHRS_FC_IMU_ID" value="IMU_ROT_ID" 
        define name="AHRS_FC_MAG_ID" value="IMU_ROT_ID"
        define name="AHRS_ALIGNER_IMU_ID" value="IMU_ROT_ID"

    if the 'ins_ekf2' ins is used,
        define name="INS_EKF2_ACCEL_ID" value="IMU_ROT_ID" 
        define name="INS_EKF2_GYRO_ID" value="IMU_ROT_ID" 
        define name="INS_EKF2_MAG_ID" value="IMU_ROT_ID" 

    if the 'ins' ins is used,
        define name="INS_INT_IMU_ID" value="IMU_ROT_ID" 
    </description>
    <section name="ROTATE_IMU" prefix="ROTATE_IMU_">
      <define name="ENABLED" value="FALSE|TRUE" description="activate or not the rotation by default"/>
    </section>
  </doc>
  <settings>
    <dl_settings>
      <dl_settings name="rot_imu">
        <dl_setting min="0" max="1" step="1" var="rotate_imu.enabled" module="imu/rotate_imu" shortname="enable" values="DISABLED|ENABLED" handler="reset"/>
      </dl_settings>
    </dl_settings>
  </settings>
  <dep>
    <depends>@imu</depends>
  </dep>
  <header>
    <file name="rotate_imu.h"/>
  </header>
  <init fun="rotate_imu_init()"/>
  <periodic fun="rotate_imu_update_dcm_matrix()" freq="500.0" autorun="TRUE"/>
  <makefile>
    <file name="rotate_imu.c"/>
    <test/>
  </makefile>
</module>
