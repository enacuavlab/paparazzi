<!DOCTYPE module SYSTEM "module.dtd">
<module name="body_stabilisation" dir="ctrl" task="control">
  <doc>
    <description>
    Module for stabilising the fuselage of a horizontal tiltwing
    </description>
    <section name="BODY_STAB" prefix="BODY_STAB_">
      <define name="ENABLED" value="FALSE|TRUE" description="activate or not the filter by default"/>
      <define name="KP_M" value="10000." description="propotionnal gain"/>
      <define name="KD_M" value="0.1" description="derivative gain"/>
      <define name="UEQ_M" value="4800" description="cmd equiibre"/>
    </section>
  </doc>

  <settings>
    <dl_settings>
      <dl_settings name="body_stab">
        <dl_setting min="0" max="1" step="1" var="body_stab.enabled" module="ctrl/body_stabilisation" shortname="enable" values="DISABLED|ENABLED" handler="reset"/>
        <dl_setting min="100." max="50000" step="10" var="body_stab.kp_m" module="ctrl/body_stabilisation" shortname="kp_m" handler="update_kp_m"/>
        <dl_setting min="100." max="50000" step="10" var="body_stab.ki_m" module="ctrl/body_stabilisation" shortname="ki_m" handler="update_ki_m"/>
        <dl_setting min="0.1" max="50000." step="1" var="body_stab.kd_m" module="ctrl/body_stabilisation" shortname="kd_m" handler="update_kd_m"/>
        <dl_setting min="1" max="9600" step="1" var="body_stab.u_eq_m" module="ctrl/body_stabilisation" shortname="u_eq_m" handler="update_ueq_m"/>
        <dl_setting min="100." max="50000" step="10" var="body_stab.kp_e" module="ctrl/body_stabilisation" shortname="kp_e" handler="update_kp_e"/>
        <dl_setting min="100." max="50000" step="10" var="body_stab.ki_e" module="ctrl/body_stabilisation" shortname="ki_e" handler="update_ki_e"/>
        <dl_setting min="0.1" max="50000." step="1" var="body_stab.kd_e" module="ctrl/body_stabilisation" shortname="kd_e" handler="update_kd_e"/>
        <dl_setting min="0" max="50000." step="1" var="body_stab.clamp_integrator" module="ctrl/body_stabilisation" shortname="clamp_inte" handler="update_clamp_int"/>
        <dl_setting min="0" max="50." step="1" var="body_stab.airspeed_lb" module="ctrl/body_stabilisation" shortname="air_lb" handler="update_airspeed_lb"/>
        <dl_setting min="0" max="50." step="1" var="body_stab.airspeed_ub" module="ctrl/body_stabilisation" shortname="air_ub" handler="update_airspeed_ub"/>
      </dl_settings>
    </dl_settings>
  </settings>

  <dep>
    <depends>rotate_imu</depends>
  </dep>
  <header>
    <file name="body_stabilisation.h"/>
  </header>
  <init fun="body_stabilisation_init()"/>
  <periodic fun="body_stabilisation_periodic()" freq="500.0" autorun="TRUE"/> <!---->
  <periodic fun="body_stabilisation_report()" freq="5.0" autorun="FALSE"/>
  <makefile>
    <file name="body_stabilisation.c"/>
    <test/>
  </makefile>
</module>
